<!DOCTYPE html>
<html lang="ja">
    <head>
    <meta charset="utf-8">
    <title>トンツーのランダム生成と再生
    </title>
    <meta name="description" content="ディスクリプションを入力">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="js/jquery-3.6.3.min.js"></script>
    <script src="js/jscwlib.js"></script>
    <style>
      .body{
        overflow-x: hidden;
      }
  </style>
    </head>
    <body>
    <!----- main ----->
    <article>
    <div>トンツーのランダム生成と再生</div>
    <script>
      //console.log("速度"+document.getElementById("speeder"));
    </script>
    <!-- <button onclick = "window.location.reload();">
      ページ更新
      </button> -->
    <section>
      <div id="running">
      </div>
      <br>
    <textarea id="textarea3" class="test" cols="43%" rows="12%" name="content" required="required">ヌナヌナホレ\nイロハニホヘトチリヌルヲワカヨタレソツネ゛゛\nナラムウヰノオクヤマケフコエテアサキユメ゛゛\nミシヱヒモセスン（ー」？、゛゜）１２３４゛゛\n５６７８９０イロハニホヘトチリヌルヲワカ゛゛\nヨタレソツネナラムウヰノオクヤマケフコエ゛゛\nテアサキユメミシヱヒモセスン（ー」？、゛゛゛\n゜）１２３４５６７８９０イロハニホヘトチ゛゛\nリヌルヲワカヨタレソツネナラムウヰノオク゛゛\nヤマケフコエテアサキユメミシヱヒモセスン゛゛\n（ー」？、゛゜）１２３４５６７８９０イロ</textarea>
<br>
<button onclick = "randome()">
  ランダム生成
  </button>
    <!-- <button onclick = "rensyu()">
    書き取り練習
    </button> -->
    <button onclick="readAloud()">通話表読み上げ</button>
    <button onclick = "teishi()">通話表読み上げ停止</button><br>
    <div id="player" style="float: left";></div>
    <div id="hunmoji"><br>０文字／分</div>
    <script>
    var m = new jscw({"wpm": 24,"ews":0.5,"eff":15});
    m.renderPlayer('player', m);
    </script>
  <br>
    <hr>
    文の長さ<br>
    <input type="range" id="example" value="30" min="1" max="35" step="1" style="width:60%;margin-left:5px";><span id="current-value"></span>
    <hr><br><br><br>
    <br><br><hr>生成する文字を選択<br>
    <input type="checkbox" id="checkbox_all" checked="checked">全選択 / 全解除
        

        <p>ア<input type="checkbox" class="checkbox_list" name="" value="ア" checked="checked">
          イ<input type="checkbox" class="checkbox_list" name="" value="イ" checked="checked">
          ウ<input type="checkbox" class="checkbox_list" name="" value="ウ" checked="checked">
          エ<input type="checkbox" class="checkbox_list" name="" value="エ" checked="checked">
          オ<input type="checkbox" class="checkbox_list" name="" value="オ" checked="checked"></p>

          <p>カ<input type="checkbox" class="checkbox_list" name="" value="カ" checked="checked">
          キ<input type="checkbox" class="checkbox_list" name="" value="キ" checked="checked">
          ク<input type="checkbox" class="checkbox_list" name="" value="ク" checked="checked">
          ケ<input type="checkbox" class="checkbox_list" name="" value="ケ" checked="checked">
          コ<input type="checkbox" class="checkbox_list" name="" value="コ" checked="checked"></p>

          <p>サ<input type="checkbox" class="checkbox_list" name="" value="サ" checked="checked">
          シ<input type="checkbox" class="checkbox_list" name="" value="シ" checked="checked">
          ス<input type="checkbox" class="checkbox_list" name="" value="ス" checked="checked">
          セ<input type="checkbox" class="checkbox_list" name="" value="セ" checked="checked">
          ソ<input type="checkbox" class="checkbox_list" name="" value="ソ" checked="checked"></p>

          <p>タ<input type="checkbox" class="checkbox_list" name="" value="タ" checked="checked">
          チ<input type="checkbox" class="checkbox_list" name="" value="チ" checked="checked">
          ツ<input type="checkbox" class="checkbox_list" name="" value="ツ" checked="checked">
          テ<input type="checkbox" class="checkbox_list" name="" value="テ" checked="checked">
          ト<input type="checkbox" class="checkbox_list" name="" value="ト" checked="checked"></p>

          <p>ナ<input type="checkbox" class="checkbox_list" name="" value="ナ" checked="checked">
          ニ<input type="checkbox" class="checkbox_list" name="" value="ニ" checked="checked">
          ヌ<input type="checkbox" class="checkbox_list" name="" value="ヌ" checked="checked">
          ネ<input type="checkbox" class="checkbox_list" name="" value="ネ" checked="checked">
          ノ<input type="checkbox" class="checkbox_list" name="" value="ノ" checked="checked"></p>

          <p>ハ<input type="checkbox" class="checkbox_list" name="" value="ハ" checked="checked">
          ヒ<input type="checkbox" class="checkbox_list" name="" value="ヒ" checked="checked">
          フ<input type="checkbox" class="checkbox_list" name="" value="フ" checked="checked">
          ヘ<input type="checkbox" class="checkbox_list" name="" value="ヘ" checked="checked">
          ホ<input type="checkbox" class="checkbox_list" name="" value="ホ" checked="checked"></p>

          <p>マ<input type="checkbox" class="checkbox_list" name="" value="マ" checked="checked">
          ミ<input type="checkbox" class="checkbox_list" name="" value="ミ" checked="checked">
          ム<input type="checkbox" class="checkbox_list" name="" value="ム" checked="checked">
          メ<input type="checkbox" class="checkbox_list" name="" value="メ" checked="checked">
          モ<input type="checkbox" class="checkbox_list" name="" value="モ" checked="checked"></p>

          <p>ヤ<input type="checkbox" class="checkbox_list" name="" value="ヤ" checked="checked">
          ユ<input type="checkbox" class="checkbox_list" name="" value="ユ" checked="checked">
          ヨ<input type="checkbox" class="checkbox_list" name="" value="ヨ" checked="checked"></p>

          <p>ラ<input type="checkbox" class="checkbox_list" name="" value="ラ" checked="checked">
          リ<input type="checkbox" class="checkbox_list" name="" value="リ" checked="checked">
          ル<input type="checkbox" class="checkbox_list" name="" value="ル" checked="checked">
          レ<input type="checkbox" class="checkbox_list" name="" value="レ" checked="checked">
          ロ<input type="checkbox" class="checkbox_list" name="" value="ロ" checked="checked"></p>

          <p>ワ<input type="checkbox" class="checkbox_list" name="" value="ワ" checked="checked">
          ヰ<input type="checkbox" class="checkbox_list" name="" value="ヰ" checked="checked">
          ヱ<input type="checkbox" class="checkbox_list" name="" value="ヱ" checked="checked">
          ヲ<input type="checkbox" class="checkbox_list" name="" value="ヲ" checked="checked">
          ン<input type="checkbox" class="checkbox_list" name="" value="ン" checked="checked"></p>
          
          <p>１<input type="checkbox" class="checkbox_list" name="" value="１" checked="checked">
            ２<input type="checkbox" class="checkbox_list" name="" value="２" checked="checked">
            ３<input type="checkbox" class="checkbox_list" name="" value="３" checked="checked">
            ４<input type="checkbox" class="checkbox_list" name="" value="４" checked="checked">
            ５<input type="checkbox" class="checkbox_list" name="" value="５" checked="checked"></p>
            <p>６<input type="checkbox" class="checkbox_list" name="" value="６" checked="checked">
            ７<input type="checkbox" class="checkbox_list" name="" value="７" checked="checked">
            ８<input type="checkbox" class="checkbox_list" name="" value="８" checked="checked">
            ９<input type="checkbox" class="checkbox_list" name="" value="９" checked="checked">
            ０<input type="checkbox" class="checkbox_list" name="" value="０" checked="checked"></p>

          

      <p>（<input type="checkbox" class="checkbox_list" name="" value="（" checked="checked"></p>
      <p>ー<input type="checkbox" class="checkbox_list" name="" value="ー" checked="checked"></p>
      <p>」<input type="checkbox" class="checkbox_list" name="" value="」" checked="checked"></p>
      <p>？<input type="checkbox" class="checkbox_list" name="" value="？" checked="checked"></p>
      <p>、<input type="checkbox" class="checkbox_list" name="" value="、" checked="checked"></p>
      <p>゛<input type="checkbox" class="checkbox_list" name="" value="゛" checked="checked"></p>
      <p>゜<input type="checkbox" class="checkbox_list" name="" value="゜" checked="checked"></p>
      <p>）<input type="checkbox" class="checkbox_list" name="" value="）" checked="checked"></p>
        <hr>
    </section>
    </article>
    <!----- /main ----->
    ソースコード→<a href="https://github.com/queezle-rekhyt/Morse_practice">こちら</a>
    </body>
    <script>

function readAloud(){
  const text = document.getElementById("textarea3").value;


    if ('speechSynthesis' in window) {
      var str = text.slice( 6 ) ;
      var result3 = str.replace(/イ/g, 'いろはのい').replace(/ロ/g, 'ろうまのろ').replace(/ハ/g, 'はがきの派').replace(/ニ/g, 'にほんのに').replace(/ホ/g, 'ほけんのほ').replace(/ヘ/g, 'へいわのへ').replace(/ト/g, 'とうきょうのと').replace(/チ/g, 'ちどりのち').replace(/リ/g, 'りんごのり').replace(/ヌ/g, 'ぬまずのぬ').replace(/ル/g, 'るすいのる').replace(/ヲ/g, 'おわりのお').replace(/ワ/g, 'わらびのわ').replace(/カ/g, 'かわせのか').replace(/ヨ/g, 'よしののよ').replace(/タ/g, 'たばこのた').replace(/レ/g, 'れんげのれ').replace(/ソ/g, 'そろばんのそ').replace(/ツ/g, 'つるかめのつ').replace(/ネ/g, 'ねずみのね').replace(/ナ/g, 'なごやのな').replace(/ラ/g, 'らっぱのら').replace(/ム/g, 'むせんのむ').replace(/ウ/g, 'うえののう').replace(/ヰ/g, 'いどのい').replace(/ノ/g, 'のはらのの').replace(/オ/g, 'おおさかのお').replace(/ク/g, 'くらぶのく').replace(/ヤ/g, 'やまとのや').replace(/マ/g, 'マッチのマ').replace(/ケ/g, 'けしきのけ').replace(/フ/g, 'ふじさんのふ').replace(/コ/g, 'こどものこ').replace(/エ/g, 'えいごのえ').replace(/テ/g, 'てがみのて').replace(/ア/g, 'あさひのあ').replace(/サ/g, 'さくらのさ').replace(/キ/g, 'きってのき').replace(/ユ/g, 'ゆみやのゆ').replace(/メ/g, 'めいじのめ').replace(/ミ/g, 'みかさのみ').replace(/シ/g, 'しんぶんのし').replace(/ヱ/g, 'かぎのあるえ').replace(/ヒ/g, 'ひこうきのひ').replace(/モ/g, 'もみじのも').replace(/セ/g, 'せかいのせ').replace(/ス/g, 'すずめのす').replace(/ン/g, 'おしまいのん').replace(/（/g, 'はじめかっこ').replace(/ー/g, 'ちょうおん').replace(/」/g, 'だんらく').replace(/？/g, 'もんぷ').replace(/？/g, 'もんぷ').replace(/、/g, 'くぎりてん').replace(/゛/g, 'だくてん').replace(/゜/g, 'はんだくてん').replace(/）/g, 'おわりかっこ').replace(/１/g, 'すうじのひと').replace(/２/g, 'すうじのに').replace(/３/g, 'すうじのさん').replace(/４/g, 'すうじのよん').replace(/５/g, 'すうじのご').replace(/６/g, 'すうじのろく').replace(/７/g, 'すうじのなな').replace(/８/g, 'すうじのはち').replace(/９/g, 'すうじのきゅう').replace(/０/g, 'すうじのまる');
      console.log(result3);
      const uttr = new SpeechSynthesisUtterance(result3);
      //速さ
      uttr.rate = 0.3;
      // 高さ 0-2 初期値:1
      uttr.pitch = 0.5;
      // 音量 0-1 初期値:1
      uttr.volume = 1.5;
      window.speechSynthesis.speak(uttr);
      } else {
        alert('大変申し訳ありません。このブラウザは音声合成に対応していません。')
      }
}

function teishi(){
  window.speechSynthesis.cancel();
}

//全選択のチェックボックス
let checkbox_all = document.querySelector("#checkbox_all");
//チェックボックスのリスト
let checkbox_list = document.querySelectorAll(".checkbox_list");

//全選択のチェックボックスイベント
checkbox_all.addEventListener('change', change_all);


function change_all() {

  //チェックされているか
  if (checkbox_all.checked) {
    //全て選択
    for (let i in checkbox_list) {
      if (checkbox_list.hasOwnProperty(i)) {
        checkbox_list[i].checked = true;
      }
    }
    
  } else {
    //全て解除
    for (let i in checkbox_list) {
      if (checkbox_list.hasOwnProperty(i)) {
        checkbox_list[i].checked = false;
      }
    }
    
  }

};


        const inputElem = document.getElementById('example'); // input要素
        const currentValueElem = document.getElementById('current-value'); // 埋め込む先のspan要素

        // 現在の値をspanに埋め込む関数
        const setCurrentValue = (val) => {
            currentValueElem.innerText = val*0.5+'行('+ val*10 +'文字)';
            var val =val*10;

            //チェックボックスに入ってるもの確認
            area = $('[class="checkbox_list"]:checked').map(function(){
            //$(this)でjQueryオブジェクトが取得できる。val()で値をvalue値を取得。
            return $(this).val();
            }).get();
            //mapの結果がjQueryオブジェクトの配列で返ってくるので、get()で生配列を取得する。
            //console.log(area);
            //['kantou','touhoku']のような形で取得できる。
            console.log(area.join(''));

            var S = area.join('');
            //var S="イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセスン（ー」？、゛゜）１２３４５６７８９０"
            var rand_str = 'ヌナヌナホレ\n';
            
            for ( var i = 1; i <= val; i++ ) {
                rand_str += S.charAt(Math.floor(Math.random() * S.length));
                if (i%20 == 0 && i!=val) {
                    rand_str += "゛゛\n";
                    if (i == 200){
                        rand_str += "ホレメ２\n";
                    }
                }
            }

            var text = document.getElementsByTagName("textarea")[0];
            text.value=rand_str;

        
        }

        // inputイベント時に値をセットする関数
        const rangeOnChange = (e) =>{
        setCurrentValue(e.target.value);
        }

        function rensyu() {


        var text = document.getElementsByTagName("textarea")[0];

        text.value="ヌナヌナホレ\nイロハニホヘトチリヌルヲワカヨタレソツネ゛゛\nナラムウヰノオクヤマケフコエテアサキユメ゛゛\nミシヱヒモセスン（ー」？、゛゜）１２３４゛゛\n５６７８９０イロハニホヘトチリヌルヲワカ゛゛\nヨタレソツネナラムウヰノオクヤマケフコエ゛゛\nテアサキユメミシヱヒモセスン（ー」？、゛゛゛\n゜）１２３４５６７８９０イロハニホヘトチ゛゛\nリヌルヲワカヨタレソツネナラムウヰノオク゛゛\nヤマケフコエテアサキユメミシヱヒモセスン゛゛\n（ー」？、゛゜）１２３４５６７８９０イロ";
        var textModMsg = document.getElementById('running');
        textModMsg.innerText = "";
        }

window.onload = () => {
        // スライダー変化時にイベントを発火
        inputElem.addEventListener('input', rangeOnChange);
        setCurrentValue(inputElem.value); // ページ読み込み時に値をセット
        rensyu();
        }

        function randome(){
          // スライダー変化時にイベントを発火
        inputElem.addEventListener('input', rangeOnChange);
        setCurrentValue(inputElem.value);
        var textModMsg = document.getElementById('running');
        textModMsg.innerText = "";
        }

m.onPlay = function () { 
    var txt = document.getElementById("textarea3").value;
    txt = txt.replace(/ヘ/g, 'ヘ　　');
    txt = txt.replace(/ム/g, 'ム　　');
    txt = txt.replace(/ラ/g, 'ラ　');
    //゛゛/nでない「゛」を「゛　」に変換する
    txt = txt.replace(/゛/g, '゛　');
    txt = txt.replace(/゛　゛　\r?\n/g, '゛゛\n');
    m.setText(txt);
    console.log("再生内容:"+ txt)
    //document.getElementsByTagName("textarea")[0].value=txt

}

// document.getElementById("example").onchange = function() {
//   // onchangeイベントが発生した時の処理を記述する
// };
    </script>
</html>